<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>ƒêƒÉng k√Ω</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.min.js" integrity="sha384-7VPbUDkoPSGFnVtYi0QogXtr74QeVeeIs99Qfg5YCF+TidwNdjvaKZX19NZ/e6oz" crossorigin="anonymous"></script>
<link rel="stylesheet" href="/static/login.css">
<style>
.red { color: red; }
.distance { margin-top: 30px; margin-bottom: 30px; }
</style>
</head>
<body>
    <!--Header-->
    <header>
        <div class="left-header">
            <div class="logo">üìö Book_shop</div>
            <nav>
                <a href="/">Trang Ch·ªß</a> <!--ƒë∆∞·ªùng d·∫´n quay v·ªÅ trang ch·ªß -->
                <a href="#">Combo gi·∫£m gi√°</a>
                <a href="#">Th·ªÉ Lo·∫°i</a>
                <a href="/cart">H·∫øt h√†ng</a>
            </nav>
        </div>
        <div class="search-login">
            <input type="text" placeholder="N·ªôi dung t√¨m ki·∫øm">
            <button class="btn-tim">T√¨m</button>
            <a href="/login"><button class="btn-dangnhap">ƒêƒÉng nh·∫≠p</button></a>
        </div>
    </header>

    <div class="container">
        <div class="text-center distance">
            <h1>ƒêƒÇNG K√ù T√ÄI KHO·∫¢N</h1>
        </div>
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}" role="alert">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        <div id="error-message" class="alert alert-danger d-none" role="alert"></div>

        <form class="form" action="/register" method="post">
            <input type="hidden" name="hanhDong" value="dang-ky" />
            <div class="row">
                <div class="col-sm-6">
                    <div class="mb-3">
                        <label for="tenDangNhap" class="form-label">T√™n ƒëƒÉng nh·∫≠p<span class="red">*</span> <span id="tenDangNhapMsg" class="red"></span></label>
                        <input type="text" class="form-control" id="tenDangNhap" name="tenDangNhap" required="required">
                    </div>
                    <div class="mb-3">
                        <label for="matKhau" class="form-label">M·∫≠t kh·∫©u<span class="red">*</span> <span id="matKhauMsg" class="red"></span></label>
                        <input type="password" class="form-control" id="matKhau" name="matKhau" required="required">
                    </div>
                    <div class="mb-3">
                        <label for="matKhauNhapLai" class="form-label">Nh·∫≠p l·∫°i m·∫≠t kh·∫©u<span class="red">*</span> <span id="msg" class="red"></span></label>
                        <input type="password" class="form-control" id="matKhauNhapLai" name="matKhauNhapLai" required="required">
                    </div>
                    <hr />
                    <div class="mb-3">
                        <label for="hoVaTen" class="form-label">H·ªç v√† t√™n</label>
                        <input type="text" class="form-control" id="hoVaTen" name="hoVaTen" value="">
                    </div>
                    <div class="mb-3">
                        <label for="gioiTinh" class="form-label">Gi·ªõi t√≠nh</label>
                        <select class="form-control" id="gioiTinh" name="gioiTinh">
                            <option></option>
                            <option value="Nam">Nam</option>
                            <option value="N·ªØ">N·ªØ</option>
                            <option value="Kh√°c">Kh√°c</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="ngaySinh" class="form-label">Ng√†y sinh</label>
                        <input type="date" class="form-control" id="ngaySinh" name="ngaySinh">
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="mb-3">
                        <label for="diaChiKhachHang" class="form-label">ƒê·ªãa ch·ªâ kh√°ch h√†ng</label>
                        <input type="text" class="form-control" id="diaChiKhachHang" name="diaChiKhachHang">
                    </div>
                    <div class="mb-3">
                        <label for="diaChiMuaHang" class="form-label">ƒê·ªãa ch·ªâ mua h√†ng</label>
                        <input type="text" class="form-control" id="diaChiMuaHang" name="diaChiMuaHang">
                    </div>
                    <div class="mb-3">
                        <label for="diaChiNhanHang" class="form-label">ƒê·ªãa ch·ªâ nh·∫≠n h√†ng</label>
                        <input type="text" class="form-control" id="diaChiNhanHang" name="diaChiNhanHang">
                    </div>
                    <div class="mb-3">
                        <label for="dienThoai" class="form-label">ƒêi·ªán tho·∫°i</label>
                        <input type="tel" class="form-control" id="dienThoai" name="dienThoai">
                    </div>
                    <div class="mb-3">
                        <label for="email" class="form-label">Email</label>
                        <input type="email" class="form-control" id="email" name="email">
                    </div>
                    <hr />
                    <div class="mb-3">
                        <label for="dongYDieuKhoan" class="form-label">ƒê·ªìng √Ω v·ªõi <a href="/terms">ƒëi·ªÅu kho·∫£n c·ªßa c√¥ng ty</a><span class="red">*</span></label>
                        <input type="checkbox" class="form-check-input" id="dongYDieuKhoan" name="dongYDieuKhoan" required="required">
                    </div>
                    <div class="mb-3">
                        <label for="dongYNhanMail" class="form-label">ƒê·ªìng √Ω nh·∫≠n email</label>
                        <input type="checkbox" class="form-check-input" id="dongYNhanMail" name="dongYNhanMail">
                    </div>
                    <input class="btn btn-primary form-control" type="submit" value="ƒêƒÉng k√Ω" name="submit" id="submit" style="visibility: hidden;" />
                </div>
            </div>
        </form>
    </div>
    <div class="footer py-4">
        <hr />
        <div class="container">
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="h5 fw-bold mb-3">BookSach_360.vn</div>
                    <div class="social-icons">
                        <a href="#" class="me-2"><i class="bi bi-facebook"></i></a>
                        <a href="#" class="me-2"><i class="bi bi-twitter"></i></a>
                        <a href="#" class="me-2"><i class="bi bi-youtube"></i></a>
                        <a href="#" class="me-2"><i class="bi bi-instagram"></i></a>
                    </div>
                </div>
                <div class="col-md-4">
                    <ul class="list-unstyled">
                        <li class="mb-2">Li√™n h·ªá: quanlysach_360@gmail.com</li>
                        <li class="mb-2">Quy ƒë·ªãnh giao h√†ng</li>
                        <li class="mb-2">Quy ƒë·ªãnh tr·∫£ h√†ng</li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <ul class="list-unstyled">
                        <li class="mb-2">Ch√≠nh s√°ch ho·∫°t ƒë·ªông</li>
                        <li class="mb-2">Ch√≠nh s√°ch tr·∫£ h√†ng</li>
                        <li class="mb-2">Ch√≠nh s√°ch b·∫£o m·∫≠t</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const tenDangNhap = document.getElementById('tenDangNhap');
        const matKhau = document.getElementById('matKhau');
        const matKhauNhapLai = document.getElementById('matKhauNhapLai');
        const tenDangNhapMsg = document.getElementById('tenDangNhapMsg');
        const matKhauMsg = document.getElementById('matKhauMsg');
        const msg = document.getElementById('msg');
        const submitBtn = document.getElementById('submit');
        const checkDieuKhoan = document.getElementById('dongYDieuKhoan');
        const errorMessage = document.getElementById('error-message');

        // H√†m ki·ªÉm tra ƒë·ªô m·∫°nh m·∫≠t kh·∫©u
        function isWeakPassword(password) {
            return (
                password.length < 8 ||
                !/[A-Z]/.test(password) ||
                !/[a-z]/.test(password) ||
                !/[0-9]/.test(password) ||
                !/[@#$%^&*()_+\-=\[\]{};:'\",.<>?/\\|~`]/.test(password)
            );
        }

        // Hi·ªÉn th·ªã n√∫t submit khi ƒë·ªìng √Ω ƒëi·ªÅu kho·∫£n
        checkDieuKhoan.addEventListener('change', function () {
            submitBtn.style.visibility = this.checked ? 'visible' : 'hidden';
        });

        // Ki·ªÉm tra ƒë·ªô d√†i t√™n ƒëƒÉng nh·∫≠p ngay khi nh·∫≠p
        tenDangNhap.addEventListener('input', function () {
            tenDangNhapMsg.textContent = (this.value.length < 3) ? " - T√™n ƒëƒÉng nh·∫≠p ph·∫£i c√≥ √≠t nh·∫•t 3 k√Ω t·ª±." : "";
            tenDangNhap.classList.toggle('is-invalid', this.value.length < 3);
        });

        // Ki·ªÉm tra ƒë·ªô m·∫°nh m·∫≠t kh·∫©u ngay khi nh·∫≠p
        matKhau.addEventListener('input', function () {
            const password = this.value;
            let errorMsg = "";

            if (isWeakPassword(password)) {
                errorMsg = " - M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 8 k√Ω t·ª±, bao g·ªìm ch·ªØ hoa, ch·ªØ th∆∞·ªùng, s·ªë v√† k√Ω t·ª± ƒë·∫∑c bi·ªát.";
            }

            matKhauMsg.textContent = errorMsg;
            matKhau.classList.toggle('is-invalid', !!errorMsg);

            // C·∫≠p nh·∫≠t th√¥ng b√°o kh√¥ng kh·ªõp n·∫øu c·∫ßn
            if (matKhauNhapLai.value && password !== matKhauNhapLai.value) {
                msg.textContent = " - M·∫≠t kh·∫©u kh√¥ng kh·ªõp!";
                matKhauNhapLai.classList.add('is-invalid');
            } else {
                msg.textContent = "";
                matKhauNhapLai.classList.remove('is-invalid');
            }
        });

        // Ki·ªÉm tra m·∫≠t kh·∫©u kh·ªõp nhau ngay khi nh·∫≠p
        matKhauNhapLai.addEventListener('input', function () {
            const password = matKhau.value;
            const confirmPassword = this.value;
            let errorMsg = "";

            if (password !== confirmPassword) {
                errorMsg = " - M·∫≠t kh·∫©u kh√¥ng kh·ªõp!";
            }

            msg.textContent = errorMsg;
            matKhauNhapLai.classList.toggle('is-invalid', !!errorMsg);

            // C·∫≠p nh·∫≠t th√¥ng b√°o ƒë·ªô m·∫°nh m·∫≠t kh·∫©u
            if (isWeakPassword(password)) {
                matKhauMsg.textContent = " - M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 8 k√Ω t·ª±, bao g·ªìm ch·ªØ hoa, ch·ªØ th∆∞·ªùng, s·ªë v√† k√Ω t·ª± ƒë·∫∑c bi·ªát.";
                matKhau.classList.add('is-invalid');
            } else {
                matKhauMsg.textContent = "";
                matKhau.classList.remove('is-invalid');
            }
        });

        // Ki·ªÉm tra form tr∆∞·ªõc khi g·ª≠i
        document.querySelector('form').addEventListener('submit', function (e) {
            const requiredFields = ['tenDangNhap', 'matKhau', 'matKhauNhapLai'];
            let isValid = true;
            let errorMessages = [];

            // Ki·ªÉm tra c√°c tr∆∞·ªùng b·∫Øt bu·ªôc
            requiredFields.forEach(function (id) {
                const input = document.getElementById(id);
                if (input && input.value.trim() === '') {
                    isValid = false;
                    input.classList.add('is-invalid');
                    errorMessages.push(`Vui l√≤ng nh·∫≠p ${input.previousElementSibling.textContent.replace('*', '')}.`);
                } else {
                    input.classList.remove('is-invalid');
                }
            });

            // Ki·ªÉm tra ƒë·ªô d√†i t√™n ƒëƒÉng nh·∫≠p
            if (tenDangNhap.value.length < 3) {
                isValid = false;
                tenDangNhap.classList.add('is-invalid');
                errorMessages.push("T√™n ƒëƒÉng nh·∫≠p ph·∫£i c√≥ √≠t nh·∫•t 3 k√Ω t·ª±.");
            }

            // Ki·ªÉm tra ƒë·ªô m·∫°nh m·∫≠t kh·∫©u
            const password = matKhau.value;
            if (isWeakPassword(password)) {
                isValid = false;
                matKhau.classList.add('is-invalid');
                errorMessages.push("M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 8 k√Ω t·ª±, bao g·ªìm ch·ªØ hoa, ch·ªØ th∆∞·ªùng, s·ªë v√† k√Ω t·ª± ƒë·∫∑c bi·ªát.");
            }

            // Ki·ªÉm tra m·∫≠t kh·∫©u kh·ªõp
            if (matKhau.value !== matKhauNhapLai.value) {
                isValid = false;
                matKhauNhapLai.classList.add('is-invalid');
                errorMessages.push("M·∫≠t kh·∫©u kh√¥ng kh·ªõp!");
            }

            // Ki·ªÉm tra ƒë·ªìng √Ω ƒëi·ªÅu kho·∫£n
            if (!checkDieuKhoan.checked) {
                isValid = false;
                errorMessages.push("Vui l√≤ng ƒë·ªìng √Ω v·ªõi ƒëi·ªÅu kho·∫£n c·ªßa c√¥ng ty.");
            }

            if (!isValid) {
                e.preventDefault();
                errorMessage.textContent = errorMessages.join(' ');
                errorMessage.classList.remove('d-none');
                window.scrollTo(0, 0);
            }
        });
    });
</script>
</html>