<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chi ti·∫øt s√°ch</title>
  <link rel="stylesheet" href="/static/login.css">
  <link rel="stylesheet" href="/static/book_detail.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <!-- Header -->
  <header>
    <div class="left-header">
      <div class="logo">üìö Book_shop</div>
      <nav>
        <a href="/">Trang Ch·ªß</a> <!-- S·ª≠a ƒë∆∞·ªùng d·∫´n -->
        <a href="#">Combo gi·∫£m gi√°</a>
        <a href="#">Th·ªÉ Lo·∫°i</a>
        <a href="#">Gi·ªè H√†ng</a>
      </nav>
    </div>
    <div class="search-login">
      <input type="text" placeholder="N·ªôi dung t√¨m ki·∫øm">
      <button class="btn-tim">T√¨m</button>
      <a href="/login"><button class="btn-dangnhap">ƒêƒÉng nh·∫≠p</button></a> <!-- ƒê√É S·ª¨A -->
    </div>
  </header>

  <!-- N·ªôi dung s√°ch -->
  <main class="container mt-5" id="book-detail">
    <!-- N·ªôi dung s√°ch s·∫Ω ƒë∆∞·ª£c render b·∫±ng JavaScript -->
  </main>

  <!-- C√°c s·∫£n ph·∫©m li√™n quan -->
  <section class="container mt-5">
    <h5 class="fw-bold mb-4">C√°c s·∫£n ph·∫©m li√™n quan</h5>
    <div class="row" id="related-products">
      <!-- C√°c s·∫£n ph·∫©m li√™n quan s·∫Ω ƒë∆∞·ª£c render t·∫°i ƒë√¢y b·∫±ng JavaScript -->
    </div>
  </section>

  <!-- Footer -->
  <div class="footer py-4 mt-5">
    <hr />
    <div class="container">
      <div class="row g-4">
        <div class="col-md-4">
          <div class="h5 fw-bold mb-3">BookSach_360.vn</div>
          <div class="social-icons">
            <a href="#" class="me-2">Facebook</a>
            <a href="#" class="me-2">Twitter</a>
            <a href="#" class="me-2">YouTube</a>
            <a href="#" class="me-2">Instagram</a>
          </div>
        </div>
        <div class="col-md-4">
          <ul class="list-unstyled">
            <li>Li√™n h·ªá: quanlysach_360@gmail.com</li>
            <li>Quy ƒë·ªãnh giao h√†ng</li>
            <li>Quy ƒë·ªãnh tr·∫£ h√†ng</li>
          </ul>
        </div>
        <div class="col-md-4">
          <ul class="list-unstyled">
            <li>Ch√≠nh s√°ch ho·∫°t ƒë·ªông</li>
            <li>Ch√≠nh s√°ch tr·∫£ h√†ng</li>
            <li>Ch√≠nh s√°ch b·∫£o m·∫≠t</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Script render chi ti·∫øt s√°ch v√† c√°c s·∫£n ph·∫©m li√™n quan -->
  <<script>
    // L·∫•y c√°c tham s·ªë t·ª´ URL
    function getBookDataFromURL() {
      const urlParams = new URLSearchParams(window.location.search);
      return {
        img: urlParams.get('img') || '/static/images/Banner.png',
        title: urlParams.get('title') || 'Gi·∫£i m√£ t√¢m l√Ω h·ªçc',
        author: urlParams.get('author') || 'Nguy·ªÖn VƒÉn A',
        category: urlParams.get('category') || 'T√¢m l√Ω h·ªçc',
        publisher: urlParams.get('publisher') || 'NXB Kim ƒê·ªìng',
        year: urlParams.get('year') || 2023,
        price: urlParams.get('price') || '95.000 VNƒê',
        description: urlParams.get('description') || 'Cu·ªën s√°ch gi√∫p b·∫°n hi·ªÉu r√µ h∆°n v·ªÅ h√†nh vi, t∆∞ duy, c·∫£m x√∫c c·ªßa con ng∆∞·ªùi qua c√°c t√¨nh hu·ªëng th·ª±c t·∫ø...'
      };
    }
  
    const relatedBooks = [
      { img: '/static/images/Banner.png', title: 'S·∫£n ph·∫©m A', desc: 'M√¥ t·∫£ chi ti·∫øt s·∫£n ph·∫©m', price: '100.000 VNƒê' },
      { img: '/static/images/Banner.png', title: 'S·∫£n ph·∫©m B', desc: 'M√¥ t·∫£ chi ti·∫øt s·∫£n ph·∫©m', price: '100.000 VNƒê' },
      { img: '/static/images/Banner.png', title: 'S·∫£n ph·∫©m C', desc: 'M√¥ t·∫£ chi ti·∫øt s·∫£n ph·∫©m', price: '100.000 VNƒê' },
      { img: '/static/images/Banner.png', title: 'S·∫£n ph·∫©m D', desc: 'M√¥ t·∫£ chi ti·∫øt s·∫£n ph·∫©m', price: '100.000 VNƒê' },
      { img: '/static/images/Banner.png', title: 'S·∫£n ph·∫©m E', desc: 'M√¥ t·∫£ chi ti·∫øt s·∫£n ph·∫©m', price: '100.000 VNƒê' },
      { img: '/static/images/Banner.png', title: 'S·∫£n ph·∫©m F', desc: 'M√¥ t·∫£ chi ti·∫øt s·∫£n ph·∫©m', price: '100.000 VNƒê' },
      { img: '/static/images/Banner.png', title: 'S·∫£n ph·∫©m E', desc: 'M√¥ t·∫£ chi ti·∫øt s·∫£n ph·∫©m', price: '100.000 VNƒê' },
      { img: '/static/images/Banner.png', title: 'S·∫£n ph·∫©m F', desc: 'M√¥ t·∫£ chi ti·∫øt s·∫£n ph·∫©m', price: '100.000 VNƒê' }
    ];
  
    function renderBookDetail(book) {
      const container = document.getElementById('book-detail');
      container.innerHTML = `
        <div class="row">
          <div class="col-md-5">
            <img src="${book.img}" class="img-fluid" alt="${book.title}">
          </div>
          <div class="col-md-7">
            <h2 class="fw-bold">${book.title}</h2>
            <p><strong>T√°c gi·∫£:</strong> ${book.author}</p>
            <p><strong>Th·ªÉ lo·∫°i:</strong> ${book.category}</p>
            <p><strong>Nh√† xu·∫•t b·∫£n:</strong> ${book.publisher}</p>
            <p><strong>NƒÉm xu·∫•t b·∫£n:</strong> ${book.year}</p>
            <p><strong>Gi√° b√°n:</strong> <span class="text-danger fw-bold">${book.price}</span></p>
            <p class="mt-3"><strong>M√¥ t·∫£:</strong> ${book.description}</p>
            <div class="d-flex gap-2 mt-3">
              <button class="btn btn-success">Th√™m v√†o gi·ªè h√†ng</button>
              <button class="btn btn-primary">Mua ngay</button>
            </div>
          </div>
        </div>
      `;
    }
  
    function renderRelatedProducts(products) {
      const container = document.getElementById('related-products');
      container.innerHTML = products.map(p => `
        <div class="col-md-4 col-lg-3 mb-4">
          <div class="card h-100 shadow-sm" style="cursor: pointer;">
            <img src="${p.img}" class="card-img-top" alt="${p.title}">
            <div class="card-body">
              <h6 class="card-title">${p.title}</h6>
              <p class="card-text small text-muted">${p.desc}</p>
              <p class="fw-bold text-danger">${p.price}</p>
            </div>
          </div>
        </div>
      `).join('');
    }
  
    function addClickEventsToRelated() {
      const cards = document.querySelectorAll('#related-products .card');
      cards.forEach((card, index) => {
        card.addEventListener('click', () => {
          const p = relatedBooks[index];
          const book = {
            title: p.title,
            img: p.img,
            author: 'T√°c gi·∫£ li√™n quan',
            category: 'Th·ªÉ lo·∫°i li√™n quan',
            publisher: 'NXB n√†o ƒë√≥',
            year: 2024,
            price: p.price,
            description: p.desc
          };
          const params = new URLSearchParams(book).toString();
          history.pushState(book, '', `?${params}`);
          renderBookDetail(book);
        });
      });
    }
  
    // X·ª≠ l√Ω khi user nh·∫•n back/forward tr√¨nh duy·ªát
    window.onpopstate = (event) => {
      if (event.state) {
        renderBookDetail(event.state);
      } else {
        const defaultBook = getBookDataFromURL();
        renderBookDetail(defaultBook);
      }
    };
  
    // Ban ƒë·∫ßu render
    const initialBook = getBookDataFromURL();
    renderBookDetail(initialBook);
    renderRelatedProducts(relatedBooks);
    addClickEventsToRelated();
  
    // S·ª± ki·ªán v·ªÅ trang ch·ªß
    document.getElementById('home-link').addEventListener('click', function(event) {
      event.preventDefault();
      window.location.href = 'trangchu.html';
    });
  </script>
  
</body>
</html>
